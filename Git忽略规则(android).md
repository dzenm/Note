### 一、忽略文件提交的三种方法

#### 方法一：在Git项目中定义.gitignore文件

通过在项目中的某个文件夹下定义一个 .gitignore 文件，在该文件中定义相应的忽略规则，则Git提交时会忽略相应的文件在 .gitignore 文件中，遵循相应的语法



#### 方法二：在Git项目的设置中指定排除文件

该方式只临时指定项目的行为，需要编辑当前项目下的 .git/info/exclude 文件，将需要忽略提交的文件写入



#### 方法三：定义全局Git的 .gitignore 文件

这种方式在不同的项目开发者之间不共享，是属于项目之上Git应用级别的行为，这种方式也需要创建 .gitignore 文件，位置可以任意放。使用命令配置Git

> git config —global core.excludesfile ~/.gitignore





### 二、Git忽略规则



####1、Git忽略规则的优先级

在 .gitignore 文件中，每一行指定一个忽略规则，Git检查忽略时会有多个来源，它的优先级如下（由高到低）

- 从命令行中读取可用的忽略规则
- 当前目录定义的规则
- 父级目录定义的规则，依次递推
- $GIT_DIR/info/exclude 文件中定义的规则
- core.excludesfile中定义的全局规则

 

####2、Git忽略规则匹配语法

在 .gitignore 文件中，每一行的忽略规则的语法如下：

- 空格不匹配任意文件，可作为分隔符，可用反斜杠转义
- \# 开头的文件标识注释，可以使用反斜杠进行转义
- ! 开头的模式标识否定，该文件将会再次被包含，如果排除了该文件的父级目录，则使用 ! 也不会再次被包含。可以使用反斜杠进行转义
- / 结束的模式只匹配文件夹以及在该文件夹路径下的内容，但是不匹配该文件 
- / 开始的模式匹配项目跟目录
- 如果一个模式不包含斜杠，则它匹配相对于当前 .gitignore 文件路径的内容，如果该模式不在 .gitignore 文件中，则相对于项目根目录
- ** 匹配多级目录，可在开始，中间，结束
- ? 通用匹配单个字符
- [] 通用匹配单个字符列表

 

#### 3、常用匹配示例

- bin/ ： 忽略当前路径下的bin文件夹，该文件夹下的所有内容都会被忽略，不忽略 bin 文件
- /bin ：忽略根目录下的bin文件
- /*.c ： 忽略 cat.c，不忽略 build/cat.c
- debug/*.obj ： 忽略 debug/io.obj，不忽略 debug/common/io.obj 和 tools/debug/io.obj
- **/foo ： 忽略/foo, a/foo, a/b/foo等
- a/**/b ： 忽略a/b, a/x/b, a/x/y/b等
- !/bin/run.sh ： 不忽略 bin 目录下的 run.sh 文件
- *.log ： 忽略所有 .log 文件
- config.php ： 忽略当前路径的 config.php 文件



#####(1)、下面我们看看常用的规则：

> 1）/mtk/                 过滤整个文件夹
>
> 2）*.zip                  过滤所有.zip文件 
>
> 3）/mtk/do.c         过滤某个具体文件



#####(2)、gitignore还可以指定要将哪些文件添加到版本管理中： 

> 1）!*.zip 
>
> 2）!/mtk/one.txt



* 则开头多了一个感叹号，Git会将满足这类规则的文件添加到版本管理中。为什么要有两种规则呢？想象一个场景：假如我们只需要管理/mtk/目录中的 `one.txt` 文件，这个目录中的其他文件都不需要管理，那么我们就需要使用如下规则：

> 1）/mtk/
> 2）!/mtk/one.txt

* 假设我们只有过滤规则，而没有添加规则，那么我们就需要把/mtk/目录下除了 `one.txt` 以外的所有文件都写出来！



#####(3)、配置语法：

以斜杠“/”开头表示目录；
以星号“*”通配多个字符；
以问号“?”通配单个字符
以方括号“[]”包含单个字符的匹配列表；
以叹号“!”表示不忽略(跟踪)匹配到的文件或目录；

此外，git 对于 `.ignore` 配置文件是按行从上到下进行规则匹配的，意味着如果前面的规则匹配的范围更大，则后面的规则将不会生效；

#####(4)、示例说明

a）规则：fd1/* 

说明：忽略目录 ` fd1` 下的全部内容；注意，不管是根目录下的 `/fd1/` 目录，还是某个子目录 `/child/fd1/` 目录，都会被忽略； 

b）规则：`/fd1/* `

说明：忽略根目录下的 ` /fd1/` 目录的全部内容； 

c）规则：` /* !.gitignore !/fw/bin/ !/fw/sf/ `

说明：忽略全部内容，但是不忽略 ` .gitignore ` 文件、根目录下的  `/fw/bin/ `  和 `/fw/sf/` 目录；



####用法及注意事项

`.gitignore`   一旦被Git记录过的文件建立规则使用后，若之后再添加规则时，新添加的规则不会起作用，对已经记录过的文件无效。若要使这些规则起作用，可以把本地缓存删除（改变成未track状态，使用如下代码），然后再提交：

> git rm -r --cached .
> git add .
> git commit -m 'update .gitignore' 



####4、.gitignore规则不生效

 `.gitignore`   只能忽略那些原来没有被track的文件，如果某些文件已经被纳入了版本管理中，则修改  `.gitignore`  是无效的。解决方法就是先把本地缓存删除（改变成未track状态），然后再提交:

> git rm -r --cached . 
>
> git add . 
>
> git commit -m 'update .gitignore'





## 注：针对 Android Studio 项目的忽略规则

* 官方给出的忽略规则

```
# Built application files
*.apk
*.ap_

# Files for the ART/Dalvik VM
*.dex

# Java class files
*.class

# Generated files
bin/
gen/
out/

# Gradle files
.gradle/
build/

# Local configuration file (sdk path, etc)
local.properties

# Proguard folder generated by Eclipse
proguard/

# Log Files
*.log

# Android Studio Navigation editor temp files
.navigation/

# Android Studio captures folder
captures/

# IntelliJ
*.iml
.idea/workspace.xml
.idea/tasks.xml
.idea/gradle.xml
.idea/assetWizardSettings.xml
.idea/dictionaries
.idea/libraries
.idea/caches

# Keystore files
# Uncomment the following line if you do not want to check your keystore files in.
#*.jks

# External native build folder generated in Android Studio 2.2 and later
.externalNativeBuild

# Google Services (e.g. APIs or Firebase)
google-services.json

# Freeline
freeline.py
freeline/
freeline_project_description.json

# fastlane
fastlane/report.xml
fastlane/Preview.html
fastlane/screenshots
fastlane/test_output
fastlane/readme.md
```



* 自定义忽略规则

```
# Built application files  不忽略apk文件
#*.apk
#*.ap_

# Files for the ART/Dalvik VM	忽略所有dex文件
*.dex

# Java class files	忽略所有class文件
*.class

# Generated files	忽略以下几个文件夹的文件
bin/
gen/
out/

# Gradle 	忽略 Gradle 文件夹下所有 files 及 gradle 有关文件
.gradle/
gradlew
gradlew.bat

# Gradle wrapper 	忽略 gradle wrapper 下的文件
gradle/

# build 	忽略 build 文件夹下所有文件及 build 有关文件	
build/
*/build/

# Local configuration file (sdk path, etc)	忽略 local.properties 文件
local.properties

# Proguard folder generated by Eclipse		忽略 Eclipse 项目 proguard/ 文件夹下的所有文件
proguard/

# Log Files	忽略 log 信息文件
*.log

# Android Studio Navigation editor temp files	忽略 android studio 的.navigation/所有文件
.navigation/

# Android Studio captures folder	忽略 android studio 的 captures/所有文件	
captures/

# IntelliJ	忽略 Intellij 项目产生的无关文件
*.iml
*/*.iml
.idea/workspace.xml
.idea/tasks.xml
.idea/gradle.xml
.idea/assetWizardSettings.xml
.idea/dictionaries
.idea/libraries
.idea/caches
.idea/modules.xml

#Android Studio captures folder		忽略 android studio captures 文件夹
/captures/

#Keystore files		忽略 KeyStore 及一些无用文件
*.jks
*.DS_Store
*/.settings/
*/.idea/
.DS_Stroe
.idea/


# External native build folder generated in Android Studio 2.2 and later
.externalNativeBuild
```

